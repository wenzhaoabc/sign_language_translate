import{P as I,Q as S,d as C,S as R,i as U,T as q,C as w,D as K,r as i,o as p,c as u,b as o,w as c,F as Z,a as n,J as v,U as H,V as k,L as J,h as L,E as f,p as O,g as Q,M as A,N as G}from"./index-ad80de0e.js";import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";const X=s=>I.post(S+"/upload_file",s),pe=s=>I.post(S+"/upload_file",s),y=s=>(O("data-v-853d0a4a"),s=s(),Q(),s),Y={class:"upload-box"},x=["src"],ee=y(()=>n("span",null,"编辑",-1)),ae=y(()=>n("span",null,"查看",-1)),se=y(()=>n("span",null,"删除",-1)),oe={key:1,class:"upload-empty"},te={class:"el-upload__tip"},le=C({name:"UploadImg"}),ie=C({...le,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(s,{emit:h}){const r=s;R(e=>({"6edab5b8":e.width,"2ff30589":e.height,"68a11ec0":e.borderRadius}));const b=U("id-"+q()),g=U(!1),d=w(A,void 0),m=w(G,void 0),_=K(()=>r.disabled||(d==null?void 0:d.disabled)),E=async e=>{let a=new FormData;a.append("file",e.file);try{const t=r.api??X,{data:l}=await t(a);h("update:imageUrl",l.url),m!=null&&m.prop&&(d==null||d.validateField([m.prop]))}catch(t){e.onError(t)}},V=()=>{h("update:imageUrl","")},T=()=>{const e=document.querySelector(`#${b.value} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},z=e=>{const a=e.size/1024/1024<r.fileSize,t=r.fileType.includes(e.type);return t||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),a||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${r.fileSize}M！`,type:"warning"})},0),t&&a},B=()=>{f({title:"温馨提示",message:"图片上传成功！",type:"success"})},D=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(e,a)=>{const t=i("Edit"),l=i("el-icon"),$=i("ZoomIn"),N=i("Delete"),M=i("Plus"),P=i("el-upload"),j=i("el-image-viewer");return p(),u("div",Y,[o(P,{id:b.value,action:"#",class:J(["upload",_.value?"disabled":"",e.drag?"no-border":""]),multiple:!1,disabled:_.value,"show-file-list":!1,"http-request":E,"before-upload":z,"on-success":B,"on-error":D,drag:e.drag,accept:e.fileType.join(",")},{default:c(()=>[e.imageUrl?(p(),u(Z,{key:0},[n("img",{src:e.imageUrl,class:"upload-image"},null,8,x),n("div",{class:"upload-handle",onClick:a[1]||(a[1]=H(()=>{},["stop"]))},[_.value?v("",!0):(p(),u("div",{key:0,class:"handle-icon",onClick:T},[o(l,null,{default:c(()=>[o(t)]),_:1}),ee])),n("div",{class:"handle-icon",onClick:a[0]||(a[0]=F=>g.value=!0)},[o(l,null,{default:c(()=>[o($)]),_:1}),ae]),_.value?v("",!0):(p(),u("div",{key:1,class:"handle-icon",onClick:V},[o(l,null,{default:c(()=>[o(N)]),_:1}),se]))])],64)):(p(),u("div",oe,[k(e.$slots,"empty",{},()=>[o(l,null,{default:c(()=>[o(M)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),n("div",te,[k(e.$slots,"tip",{},void 0,!0)]),g.value?(p(),L(j,{key:0,"url-list":[e.imageUrl],onClose:a[2]||(a[2]=F=>g.value=!1)},null,8,["url-list"])):v("",!0)])}}});const re=W(ie,[["__scopeId","data-v-853d0a4a"]]);export{re as U,pe as a,X as u};
